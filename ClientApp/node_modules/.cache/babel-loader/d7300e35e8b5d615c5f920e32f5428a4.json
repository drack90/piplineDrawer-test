{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\drack90\\\\source\\\\repos\\\\appTestRosneft\\\\ClientApp\\\\src\\\\components\\\\Pipline.js\";\nimport React, { Component } from 'react';\nimport { render } from 'react-dom'; //import { CanvasBoard } from './CanvasBoard'\n//mport { PiplineSegment } from './PiplineSegment'\n\nimport './css/Pipline.css';\nimport { PiplineSegment } from './PiplineSegment';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class Pipline extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      piplinesSegmentCount: 0\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"piplineSections\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-xxl-8 col-xl-8 col-lg-8\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"canvasContainer\",\n              children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n                id: \"piplineCanvas\",\n                width: \"740\",\n                height: \"425\",\n                onMouseDown: e => {\n                  let newEvent = e.nativeEvent;\n                  HandleMouseDown(newEvent);\n                },\n                onMouseUp: e => {\n                  let nativeEvent = e.nativeEvent;\n                  HandleMouseUp(nativeEvent);\n                },\n                onMouseMove: e => {\n                  let nativeEvent = e.nativeEvent;\n                  HandleMouseMove(nativeEvent);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 22,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 21,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 20,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-xxl-4 col-xl-4 col-lg-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"boardContainer\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"canvasBoard_componen\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-primary\",\n                  onClick: (activeCanvas, AddPipline),\n                  children: \" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u044B\\u0439 \\u0442\\u0440\\u0443\\u0431\\u043E\\u043F\\u0440\\u043E\\u0432\\u043E\\u0434 \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 41,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-success\",\n                  onClick: SetAddPointActive,\n                  children: \" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0443\\u0437\\u0435\\u043B \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 42,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-danger\",\n                  children: \" \\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0443\\u0437\\u0435\\u043B \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 43,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-warning\",\n                  onClick: getCollisium,\n                  children: \" \\u0420\\u0430\\u0441\\u0441\\u0447\\u0438\\u0442\\u0430\\u0442\\u044C \\u043F\\u0435\\u0440\\u0435\\u0441\\u0435\\u0447\\u0435\\u043D\\u0438\\u044F\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 44,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 40,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 39,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"piplineElements\",\n              id: \"piplineItems\",\n              children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"piplineList\",\n                id: \"piplineList\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 48,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 47,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 19,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 18,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 17,\n      columnNumber: 13\n    }, this);\n  }\n\n}\nPipline.dislpayName = Pipline.name;\nlet piplines = [];\nlet mouseDown = false;\nlet piplinesCount = 0;\nlet defaultId = 0;\nlet defaultPoint = [0, 0];\nlet AddPointActive = false;\nlet downOnSelected = false;\nlet points = [];\nlet selectedNumber = -1;\nlet activePipline = -1;\nlet linesArr = [];\n\nfunction SetAddPointActive(pipline, point) {\n  AddPointActive = true;\n  console.log(\"Add active\");\n}\n\n_c = SetAddPointActive;\n\nlet log = () => {\n  console.log('kek');\n};\n\nfunction renderPiplineItems() {\n  return render(piplines.map(item => /*#__PURE__*/_jsxDEV(\"li\", {\n    id: item.id + \"pipline\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"pipline-btn\",\n      type: \"button\",\n      onClick: () => setPipline(item.id),\n      children: item.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      className: \"close red\",\n      \"aria-label\": \"Close\",\n      onClick: () => DeletePipline(item.id),\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        \"aria-hidden\": \"true\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 21\n    }, this)]\n  }, item.id, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 13\n  }, this)), document.getElementById('piplineList'));\n}\n\nfunction setPipline(id) {\n  if (activePipline !== id && activePipline !== -1) {\n    document.getElementById(activePipline + \"pipline\").classList.remove('pipline-btn__active');\n  }\n\n  let pipline = document.getElementById(id + \"pipline\");\n\n  if (pipline) {\n    pipline.classList.add('pipline-btn__active');\n    activePipline = id;\n  }\n}\n\nfunction getRandomColor() {\n  var letters = '0123456789ABCDEF';\n  var color = '#';\n\n  for (var i = 0; i < 6; i++) {\n    color += letters[Math.floor(Math.random() * 16)];\n  }\n\n  return color;\n}\n\nfunction AddPipline() {\n  let color = getRandomColor();\n  let pipline = {\n    id: piplinesCount + 1,\n    name: \"Трубопровод \" + (piplinesCount + 1),\n    color: color,\n    points: []\n  };\n  piplines.push(pipline);\n  piplinesCount += 1;\n  renderPiplineItems();\n\n  if (piplines.length <= 1) {\n    activePipline = pipline.id;\n    setPipline(pipline.id);\n  }\n} //Проверить перед деплоем\n\n\n_c2 = AddPipline;\n\nfunction DeletePipline(id) {\n  for (const key in piplines) {\n    if (Object.hasOwnProperty.call(piplines, key)) {\n      const pipline = piplines[key];\n\n      if (pipline.id === id) {\n        console.log(key);\n\n        if (key === '0') {\n          console.log(\"0000\");\n          piplines.shift();\n          piplinesCount = 0;\n          activePipline = -1;\n        } else {\n          piplines.splice(key, key);\n        }\n\n        renderPiplineItems();\n        DrawPipeline();\n      }\n    }\n  }\n}\n\n_c3 = DeletePipline;\n\nlet activeCanvas = () => {\n  let canvas = document.getElementById('piplineCanvas').classList.toggle('canvas_active');\n};\n\nlet addPointsToPipline = (piplineIndex, x, y) => {\n  let point = {\n    x,\n    y\n  };\n  piplines[piplineIndex - 1].points.push(point);\n};\n\nfunction TrySelectPoint(x, y) {\n  for (var i = 0; i < points.length; i++) {\n    var point = points[i];\n\n    if (x >= point.x - 5 && x <= point.x + 5 && y >= point.y - 5 && y <= point.y + 5) {\n      selectedNumber = i;\n      DrawPipeline();\n      return true;\n    }\n  }\n\n  console.log(points);\n  return false;\n}\n\n_c4 = TrySelectPoint;\n\nfunction HandleMouseDown(event) {\n  mouseDown = true;\n\n  if (AddPointActive) {\n    var x = event.offsetX;\n    var y = event.offsetY;\n    addPointsToPipline(activePipline, x, y);\n    DrawPipeline();\n    AddPointActive = false;\n  } else {\n    x = event.offsetX;\n    y = event.offsetY;\n    downOnSelected = TrySelectPoint(x, y);\n  }\n}\n\n_c5 = HandleMouseDown;\n\nfunction HandleMouseMove(event) {\n  if (mouseDown) {\n    if (downOnSelected) {\n      var x = event.offsetX;\n      var y = event.offsetY;\n      var point = points[selectedNumber];\n      point.x = x;\n      point.y = y;\n      DrawPipeline();\n    }\n  }\n}\n\n_c6 = HandleMouseMove;\n\nfunction HandleMouseUp() {\n  mouseDown = false;\n  downOnSelected = false;\n}\n\n_c7 = HandleMouseUp;\n\nfunction DrawPipeline() {\n  var canvas = document.getElementById('piplineCanvas');\n  var ctx = canvas.getContext('2d');\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n  if (points.length > 0) {\n    console.log('driwe line');\n    DrawLines();\n  }\n\n  piplines.forEach(pipline => {\n    for (const key in pipline.points) {\n      if (Object.hasOwnProperty.call(pipline.points, key)) {\n        if (pipline.points.length > 0) {\n          DrawLines();\n        }\n\n        const point = pipline.points[key];\n        console.log('draw point');\n        DrawPoint(point.x, point.y, pipline.color);\n      }\n    }\n  });\n}\n\n_c8 = DrawPipeline;\n\nfunction DrawPoint(x, y, color) {\n  var canvas = document.getElementById('piplineCanvas');\n  var ctx = canvas.getContext('2d');\n  ctx.beginPath();\n  ctx.arc(x, y, 5, 0, getRadians(360));\n  ctx.fillStyle = color;\n  ctx.moveTo(x, y);\n  ctx.fill();\n}\n\n_c9 = DrawPoint;\n\nfunction DrawLines() {\n  var canvas = document.getElementById('piplineCanvas');\n  var ctx = canvas.getContext('2d');\n  console.log('drawLines');\n\n  for (const key in piplines) {\n    if (Object.hasOwnProperty.call(piplines, key)) {\n      const pipline = piplines[key];\n\n      if (pipline.points.length > 0) {\n        ctx.moveTo(pipline.points[0].x, pipline.points[0].y);\n        console.log(pipline);\n\n        for (var i = 0; i < pipline.points.length; i++) {\n          ctx.lineTo(pipline.points[i].x, pipline.points[i].y);\n          ctx.strokeStyle = pipline.color;\n        }\n      }\n    }\n\n    ctx.stroke();\n    ctx.beginPath();\n  }\n}\n\n_c10 = DrawLines;\n\nfunction getRadians(degrees) {\n  return Math.PI / 180 * degrees;\n}\n\nlet line_intersect = (line1, line2) => {\n  // Check if none of the lines are of length 0\n  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point\n  let line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY;\n  line1StartX = line1[0].x;\n  line1StartY = line1[0].y;\n  line1EndX = line1[1].x;\n  line1EndY = line1[1].y;\n  line2StartX = line2[0].x;\n  line2StartY = line2[0].y;\n  line2EndX = line2[1].x;\n  line2EndY = line2[1].y;\n  var denominator,\n      a,\n      b,\n      numerator1,\n      numerator2,\n      result = {\n    x: null,\n    y: null,\n    onLine1: false,\n    onLine2: false\n  };\n  denominator = (line2EndY - line2StartY) * (line1EndX - line1StartX) - (line2EndX - line2StartX) * (line1EndY - line1StartY);\n\n  if (denominator == 0) {\n    return result;\n  }\n\n  a = line1StartY - line2StartY;\n  b = line1StartX - line2StartX;\n  numerator1 = (line2EndX - line2StartX) * a - (line2EndY - line2StartY) * b;\n  numerator2 = (line1EndX - line1StartX) * a - (line1EndY - line1StartY) * b;\n  a = numerator1 / denominator;\n  b = numerator2 / denominator; // if we cast these lines infinitely in both directions, they intersect here:\n\n  result.x = line1StartX + a * (line1EndX - line1StartX);\n  result.y = line1StartY + a * (line1EndY - line1StartY); // if line1 is a segment and line2 is infinite, they intersect if:\n\n  if (a > 0 && a < 1) {\n    result.onLine1 = true;\n  } // if line2 is a segment and line1 is infinite, they intersect if:\n\n\n  if (b > 0 && b < 1) {\n    result.onLine2 = true;\n  } // if line1 and line2 are segments, they intersect if both of the above are true\n\n\n  return result;\n};\n\nlet getCollisium = () => {\n  //при первой иттерации, убираем первый элемент первого массива из расчетов т.к. с ним высчитывать уже нет смысла - т.к. в первой же иттерации он сравнивает себя с всеми отрезками \n  for (let i = 0; i < piplines.length; i++) {\n    //количество иттераций от количества пайплайнов:\n    for (let y = 0; y < piplines[i].points.length; y++) {\n      //вложенные иттерации от количества поинтов в пайплайне \n      const line1 = [];\n\n      if (piplines[i].points[y + 1]) {\n        line1.push(piplines[i].points[y]);\n        line1.push(piplines[i].points[y + 1]);\n      } else {\n        break;\n        console.log('====================================');\n        console.log('пустое действие');\n        console.log('====================================');\n      }\n\n      console.log('====================================');\n      console.log(line1);\n      console.log('====================================');\n    } // const line1 = piplines[i].points;\n    // if(i+1 <= piplines.length ){\n    //     const line2 = piplines[i + 1].points\n    //     let result = line_intersect(line1, line2)\n    //     console.log('====================================');\n    //     console.log(result);\n    //     console.log('====================================');\n    //     DrawPoint(result.x, result.y, \"red\")\n    // }\n\n  }\n};\n\nlet getAlllines = () => {\n  piplines.forEach((pipline, index) => {\n    for (let i = 0; i < pipline.points.length; i++) {}\n  });\n};\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10;\n\n$RefreshReg$(_c, \"SetAddPointActive\");\n$RefreshReg$(_c2, \"AddPipline\");\n$RefreshReg$(_c3, \"DeletePipline\");\n$RefreshReg$(_c4, \"TrySelectPoint\");\n$RefreshReg$(_c5, \"HandleMouseDown\");\n$RefreshReg$(_c6, \"HandleMouseMove\");\n$RefreshReg$(_c7, \"HandleMouseUp\");\n$RefreshReg$(_c8, \"DrawPipeline\");\n$RefreshReg$(_c9, \"DrawPoint\");\n$RefreshReg$(_c10, \"DrawLines\");","map":{"version":3,"sources":["C:/Users/drack90/source/repos/appTestRosneft/ClientApp/src/components/Pipline.js"],"names":["React","Component","render","PiplineSegment","Pipline","state","piplinesSegmentCount","e","newEvent","nativeEvent","HandleMouseDown","HandleMouseUp","HandleMouseMove","activeCanvas","AddPipline","SetAddPointActive","getCollisium","dislpayName","name","piplines","mouseDown","piplinesCount","defaultId","defaultPoint","AddPointActive","downOnSelected","points","selectedNumber","activePipline","linesArr","pipline","point","console","log","renderPiplineItems","map","item","id","setPipline","DeletePipline","document","getElementById","classList","remove","add","getRandomColor","letters","color","i","Math","floor","random","push","length","key","Object","hasOwnProperty","call","shift","splice","DrawPipeline","canvas","toggle","addPointsToPipline","piplineIndex","x","y","TrySelectPoint","event","offsetX","offsetY","ctx","getContext","clearRect","width","height","DrawLines","forEach","DrawPoint","beginPath","arc","getRadians","fillStyle","moveTo","fill","lineTo","strokeStyle","stroke","degrees","PI","line_intersect","line1","line2","line1StartX","line1StartY","line1EndX","line1EndY","line2StartX","line2StartY","line2EndX","line2EndY","denominator","a","b","numerator1","numerator2","result","onLine1","onLine2","getAlllines","index"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { render } from 'react-dom'\r\n//import { CanvasBoard } from './CanvasBoard'\r\n//mport { PiplineSegment } from './PiplineSegment'\r\nimport './css/Pipline.css'\r\nimport { PiplineSegment } from './PiplineSegment';\r\n\r\nexport class Pipline extends Component {\r\n    static dislpayName = Pipline.name;\r\n\r\n    state = {\r\n        piplinesSegmentCount: 0\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <section className=\"piplineSections\">\r\n                <div className=\"container\">\r\n                   <div className=\"row\">\r\n                        <div className=\"col-xxl-8 col-xl-8 col-lg-8\">\r\n                            <div className=\"canvasContainer\">\r\n                                <canvas id=\"piplineCanvas\" width=\"740\" height=\"425\"\r\n                                    onMouseDown={(e) => {\r\n                                        let newEvent = e.nativeEvent;\r\n                                        HandleMouseDown(newEvent)\r\n                                    }}\r\n                                    onMouseUp={e => {\r\n                                        let nativeEvent = e.nativeEvent;\r\n                                        HandleMouseUp(nativeEvent);\r\n                                    }}\r\n                                    onMouseMove={e => {\r\n                                        let nativeEvent = e.nativeEvent;\r\n                                        HandleMouseMove(nativeEvent);\r\n                                    }}                                >\r\n                                </canvas>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col-xxl-4 col-xl-4 col-lg-4\">\r\n                            <div className=\"boardContainer\">\r\n                                <div className=\"canvasBoard_componen\">\r\n                                    <button className=\"btn btn-primary\" onClick={activeCanvas, AddPipline}> Добавить новый трубопровод </button>\r\n                                    <button className=\"btn btn-success\" onClick={SetAddPointActive}> Добавить узел </button>\r\n                                    <button className=\"btn btn-danger\" > Удалить узел </button>\r\n                                    <button className=\"btn btn-warning\" onClick={getCollisium}> Рассчитать пересечения</button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"piplineElements\" id=\"piplineItems\">\r\n                                <ul className=\"piplineList\" id=\"piplineList\">\r\n                                    \r\n                                </ul>\r\n                            </div>\r\n                        </div>\r\n                   </div>\r\n                </div>    \r\n            </section>\r\n           \r\n        );\r\n    }\r\n\r\n\r\n    \r\n}\r\n\r\n\r\n\r\nlet piplines = []\r\nlet mouseDown = false\r\nlet piplinesCount = 0;\r\nlet defaultId = 0;\r\nlet defaultPoint = [0, 0]\r\nlet AddPointActive = false\r\nlet downOnSelected = false;\r\nlet points = []\r\nlet selectedNumber = -1;\r\nlet activePipline = -1;\r\nlet linesArr = []\r\n\r\n \r\n\r\nfunction SetAddPointActive(pipline, point) {\r\n    AddPointActive = true;\r\n    console.log(\"Add active\");\r\n}\r\n\r\nlet log = () => {\r\n    console.log('kek')\r\n}\r\n\r\nfunction renderPiplineItems() {\r\n    return render(\r\n        piplines.map((item) => (\r\n            <li key={item.id} id={item.id + \"pipline\"}>\r\n                <button className=\"pipline-btn\" type=\"button\" onClick={() =>setPipline(item.id)}>{item.name}</button> \r\n                    <button type=\"button\" className=\"close red\" aria-label=\"Close\" onClick={()=>DeletePipline(item.id)}>\r\n                            <span aria-hidden=\"true\">&times;</span>\r\n                    </button>\r\n            </li>\r\n        )),\r\n        document.getElementById('piplineList')\r\n    );\r\n}\r\n\r\nfunction setPipline(id) {\r\n   \r\n    if (activePipline !== id && activePipline !== -1) {\r\n        document.getElementById(activePipline + \"pipline\").classList.remove('pipline-btn__active')\r\n    }\r\n    let pipline = document.getElementById(id + \"pipline\")\r\n\r\n    if(pipline){\r\n        pipline.classList.add('pipline-btn__active')\r\n        activePipline = id;\r\n\r\n    }\r\n    \r\n}\r\n\r\nfunction getRandomColor() {\r\n    var letters = '0123456789ABCDEF';\r\n    var color = '#';\r\n    for (var i = 0; i < 6; i++) {\r\n        color += letters[Math.floor(Math.random() * 16)];\r\n    }\r\n    return color;\r\n}\r\n\r\nfunction AddPipline() {\r\n    let color = getRandomColor()\r\n    let pipline = {\r\n        id: piplinesCount + 1,\r\n        name: \"Трубопровод \" + (piplinesCount + 1),\r\n        color: color,\r\n        points: []\r\n    }\r\n    piplines.push(pipline)\r\n    piplinesCount += 1\r\n    renderPiplineItems()\r\n    if (piplines.length <= 1) {\r\n        activePipline = pipline.id\r\n        setPipline(pipline.id)\r\n    }\r\n\r\n}\r\n\r\n\r\n//Проверить перед деплоем\r\nfunction DeletePipline(id) {\r\n\r\n    for (const key in piplines) {\r\n        if (Object.hasOwnProperty.call(piplines, key)) {\r\n            const pipline = piplines[key];\r\n            if(pipline.id === id){\r\n                console.log(key);\r\n                if(key === '0'){\r\n                    console.log(\"0000\");\r\n                    piplines.shift()\r\n                    piplinesCount = 0\r\n                    activePipline = -1\r\n                }else{\r\n                    piplines.splice(key, key)\r\n                }\r\n                renderPiplineItems();\r\n                DrawPipeline();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nlet activeCanvas = () => {\r\n    let canvas = document.getElementById('piplineCanvas').classList.toggle('canvas_active')\r\n}\r\n\r\n\r\nlet addPointsToPipline = (piplineIndex, x, y) =>{\r\n    let point = {x, y};\r\n    piplines[piplineIndex-1].points.push(point);\r\n}\r\n\r\nfunction TrySelectPoint(x, y) {\r\n    for (var i = 0; i < points.length; i++) {\r\n        var point = points[i];\r\n        if (x >= point.x - 5 && x <= point.x + 5 && y >= point.y - 5 && y <= point.y + 5) {\r\n            selectedNumber = i;\r\n            DrawPipeline();\r\n            return true;\r\n        }\r\n    }\r\n    console.log(points)\r\n    return false;\r\n}\r\nfunction HandleMouseDown(event) {\r\n    mouseDown = true;\r\n    if (AddPointActive) {\r\n        var x = event.offsetX;\r\n        var y = event.offsetY;\r\n        addPointsToPipline(activePipline, x, y)\r\n        DrawPipeline();\r\n        AddPointActive = false;\r\n    }\r\n    else {\r\n        x = event.offsetX;\r\n        y = event.offsetY;\r\n        downOnSelected = TrySelectPoint(x, y);\r\n    }\r\n\r\n}\r\nfunction HandleMouseMove(event) {\r\n    if (mouseDown) {\r\n        if (downOnSelected) {\r\n            var x = event.offsetX;\r\n            var y = event.offsetY;\r\n            var point = points[selectedNumber];\r\n            point.x = x;\r\n            point.y = y;\r\n            DrawPipeline();\r\n        }\r\n    }\r\n}\r\n\r\nfunction HandleMouseUp() {\r\n    mouseDown = false;\r\n    downOnSelected = false;\r\n}\r\n\r\nfunction DrawPipeline() {\r\n    var canvas = document.getElementById('piplineCanvas');\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    if (points.length > 0) {\r\n        console.log('driwe line');\r\n        DrawLines();\r\n    }\r\n    piplines.forEach(pipline => {\r\n        for (const key in pipline.points) {\r\n            if (Object.hasOwnProperty.call(pipline.points, key)) {\r\n                if(pipline.points.length > 0){\r\n                    DrawLines();\r\n                }\r\n                const point = pipline.points[key];\r\n                console.log('draw point');\r\n                DrawPoint(point.x, point.y, pipline.color)\r\n            }\r\n        }\r\n    });\r\n\r\n}\r\n\r\nfunction DrawPoint(x, y, color) {\r\n    var canvas = document.getElementById('piplineCanvas');\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, 5, 0, getRadians(360));\r\n    ctx.fillStyle = color;\r\n    ctx.moveTo(x, y);\r\n    ctx.fill();\r\n}\r\n\r\nfunction DrawLines() {\r\n    var canvas = document.getElementById('piplineCanvas');\r\n    var ctx = canvas.getContext('2d');\r\n    console.log('drawLines');\r\n    for (const key in piplines) {\r\n        if (Object.hasOwnProperty.call(piplines, key) ) {\r\n            const pipline = piplines[key];\r\n            if(pipline.points.length > 0 ){\r\n                ctx.moveTo(pipline.points[0].x, pipline.points[0].y);\r\n                console.log(pipline);\r\n                for (var i = 0; i < pipline.points.length; i++) {\r\n                    ctx.lineTo(pipline.points[i].x, pipline.points[i].y);                \r\n                    ctx.strokeStyle = pipline.color;\r\n                }\r\n            }\r\n        }\r\n        ctx.stroke()\r\n        ctx.beginPath();\r\n    }\r\n\r\n}\r\n\r\nfunction getRadians(degrees) {\r\n    return (Math.PI / 180) * degrees;\r\n}\r\n\r\nlet line_intersect = (line1, line2) => {\r\n    // Check if none of the lines are of length 0\r\n      // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point\r\n      let line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY\r\n      line1StartX = line1[0].x\r\n      line1StartY = line1[0].y\r\n      line1EndX = line1[1].x\r\n      line1EndY = line1[1].y\r\n      line2StartX = line2[0].x\r\n      line2StartY = line2[0].y\r\n      line2EndX = line2[1].x\r\n      line2EndY = line2[1].y\r\n      var denominator, a, b, numerator1, numerator2, result = {\r\n        x: null,\r\n        y: null,\r\n        onLine1: false,\r\n        onLine2: false\r\n    };\r\n    denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY));\r\n    if (denominator == 0) {\r\n        return result;\r\n    }\r\n    a = line1StartY - line2StartY;\r\n    b = line1StartX - line2StartX;\r\n    numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b);\r\n    numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b);\r\n    a = numerator1 / denominator;\r\n    b = numerator2 / denominator;\r\n\r\n    // if we cast these lines infinitely in both directions, they intersect here:\r\n    result.x = line1StartX + (a * (line1EndX - line1StartX));\r\n    result.y = line1StartY + (a * (line1EndY - line1StartY));\r\n\r\n    // if line1 is a segment and line2 is infinite, they intersect if:\r\n    if (a > 0 && a < 1) {\r\n        result.onLine1 = true;\r\n    }\r\n    // if line2 is a segment and line1 is infinite, they intersect if:\r\n    if (b > 0 && b < 1) {\r\n        result.onLine2 = true;\r\n    }\r\n    // if line1 and line2 are segments, they intersect if both of the above are true\r\n    return result;\r\n}\r\n\r\nlet getCollisium = () =>{\r\n    //при первой иттерации, убираем первый элемент первого массива из расчетов т.к. с ним высчитывать уже нет смысла - т.к. в первой же иттерации он сравнивает себя с всеми отрезками \r\n\r\n    for (let i = 0; i < piplines.length; i++) { //количество иттераций от количества пайплайнов:\r\n            for (let y = 0; y < piplines[i].points.length; y++) { //вложенные иттерации от количества поинтов в пайплайне \r\n                const line1 = []\r\n                if(piplines[i].points[y+1]){\r\n                    line1.push(piplines[i].points[y])\r\n                    line1.push(piplines[i].points[y+1])\r\n                }else{\r\n                    break;\r\n                    console.log('====================================');\r\n                    console.log('пустое действие');\r\n                    console.log('====================================');\r\n                    \r\n                }\r\n            \r\n                console.log('====================================');\r\n                console.log(line1);\r\n                console.log('====================================');\r\n                \r\n            }\r\n\r\n        // const line1 = piplines[i].points;\r\n        // if(i+1 <= piplines.length ){\r\n        //     const line2 = piplines[i + 1].points\r\n           \r\n        //     let result = line_intersect(line1, line2)\r\n        //     console.log('====================================');\r\n        //     console.log(result);\r\n        //     console.log('====================================');\r\n        //     DrawPoint(result.x, result.y, \"red\")\r\n            \r\n        // }\r\n        \r\n    }\r\n}\r\n\r\nlet getAlllines = () => { \r\n    piplines.forEach((pipline, index) => {\r\n        for (let i = 0; i < pipline.points.length; i++) {\r\n            \r\n        }\r\n    });\r\n}"]},"metadata":{},"sourceType":"module"}