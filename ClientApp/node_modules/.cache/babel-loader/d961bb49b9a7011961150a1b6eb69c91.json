{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\drack90\\\\source\\\\repos\\\\appTestRosneft\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";import _createClass from\"C:\\\\Users\\\\drack90\\\\source\\\\repos\\\\appTestRosneft\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";import _inherits from\"C:\\\\Users\\\\drack90\\\\source\\\\repos\\\\appTestRosneft\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\inherits.js\";import _createSuper from\"C:\\\\Users\\\\drack90\\\\source\\\\repos\\\\appTestRosneft\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createSuper.js\";import React,{Component}from'react';import{render}from'react-dom';import'./css/Pipline.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Pipline=/*#__PURE__*/function(_Component){_inherits(Pipline,_Component);var _super=_createSuper(Pipline);function Pipline(){var _this;_classCallCheck(this,Pipline);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={piplinesSegmentCount:0};return _this;}_createClass(Pipline,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"section\",{className:\"piplineSections\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger alert-dismissible fade\",id:\"alert-message\",role:\"alert\",children:[\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u043C\\u043E\\u0436\\u043D\\u043E \\u0442\\u043E\\u043B\\u044C\\u043A\\u043E \\u043F\\u0435\\u0440\\u0432\\u0443\\u044E \\u0438 \\u043F\\u043E\\u0441\\u043B\\u0435\\u0434\\u043D\\u044E\\u044E \\u0442\\u043E\\u0447\\u043A\\u0443 \\u0442\\u0440\\u0443\\u0431\\u043E\\u043F\\u0440\\u043E\\u0432\\u043E\\u0434\\u0430.\",/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"alert\",\"aria-label\":\"Close\",onClick:closeAlert,children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pipline-title mx-auto\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0422\\u0435\\u0441\\u0442\\u043E\\u0432\\u043E\\u0435 \\u0437\\u0430\\u0434\\u0430\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"h6\",{children:\"\\u0417\\u0430\\u0434\\u0430\\u0447\\u0430: \\u0440\\u0435\\u0430\\u043B\\u0438\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E\\u0441\\u0442\\u0440\\u043E\\u0435\\u043D\\u0438\\u0435 \\u0438 \\u043E\\u0431\\u0440\\u0430\\u0431\\u043E\\u0442\\u043A\\u0443 \\u0442\\u0440\\u0443\\u0431\\u043E\\u043F\\u0440\\u043E\\u0432\\u043E\\u0434\\u043E\\u0432 \\u0441 \\u043F\\u0440\\u043E\\u0432\\u0435\\u0440\\u043A\\u043E\\u0439 \\u043A\\u043E\\u043B\\u043B\\u0438\\u0437\\u0438\\u0439\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-xxl-8 col-xl-8 col-lg-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"canvasContainer\",children:/*#__PURE__*/_jsx(\"canvas\",{id:\"piplineCanvas\",width:\"700\",height:\"350\",onMouseDown:function onMouseDown(e){var newEvent=e.nativeEvent;HandleMouseDown(newEvent);},onMouseUp:function onMouseUp(e){var newEvent=e.nativeEvent;HandleMouseUp(newEvent);},onMouseMove:function onMouseMove(e){var newEvent=e.nativeEvent;HandleMouseMove(newEvent);}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-xxl-4 col-xl-4 col-lg-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"boardContainer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"canvasBoard_componen\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:AddPipline,children:\" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u044B\\u0439 \\u0442\\u0440\\u0443\\u0431\\u043E\\u043F\\u0440\\u043E\\u0432\\u043E\\u0434 \"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:SetAddPointActive,children:\" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0443\\u0437\\u0435\\u043B \"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:deleteSelectedPoint,children:\" \\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0443\\u0437\\u0435\\u043B \"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-warning\",onClick:getCollisium,children:\" \\u0420\\u0430\\u0441\\u0441\\u0447\\u0438\\u0442\\u0430\\u0442\\u044C \\u043F\\u0435\\u0440\\u0435\\u0441\\u0435\\u0447\\u0435\\u043D\\u0438\\u044F\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"piplineElements\",id:\"piplineItems\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"piplineList\",id:\"piplineList\"})})]})]})]})]});}}]);return Pipline;}(Component);Pipline.dislpayName=Pipline.name;var piplines=[];var mouseDown=false;var piplinesCount=0;var defaultId=0;var defaultPoint=[0,0];var AddPointActive=false;var downOnSelected=false;var points=[];var selectedNumber=-1;var activePipline=-1;var linesArr=[];function SetAddPointActive(pipline,point){activeCanvas();AddPointActive=true;}var activeCanvas=function activeCanvas(){var color=piplines[activePipline].color;var canvas=document.getElementById('piplineCanvas');canvas.style.borderColor=color;};var deActiveCanvas=function deActiveCanvas(){var defaultColor='#1b6ec2';var canvas=document.getElementById('piplineCanvas');canvas.style.borderColor=defaultColor;};var renderAlert=function renderAlert(){document.getElementById('alert-message').classList.add('show');autoCloseAlert(2000);};var autoCloseAlert=function autoCloseAlert(time){setTimeout(function(){closeAlert();},time);};var closeAlert=function closeAlert(){document.getElementById('alert-message').classList.remove('show');};var renderPiplineItems=function renderPiplineItems(){return render(piplines.map(function(item,key){return/*#__PURE__*/_jsxs(\"li\",{id:key+\"pipline\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"pipline-btn\",type:\"button\",onClick:function onClick(){return setPipline(key);},children:item.name}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"close red\",\"aria-label\":\"Close\",onClick:function onClick(){return DeletePipline(item.id);},children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]},item.id);}),document.getElementById('piplineList'));};var setPipline=function setPipline(key){if(activePipline!==key&&activePipline!==-1&&document.getElementById(activePipline+\"pipline\")){document.getElementById(activePipline+\"pipline\").classList.remove('pipline-btn__active');}var pipline=document.getElementById(key+\"pipline\");if(pipline){pipline.classList.add('pipline-btn__active');activePipline=key;}};var getRandomColor=function getRandomColor(){var letters='0123456789ABCDEF';var color='#';for(var i=0;i<6;i++){color+=letters[Math.floor(Math.random()*16)];}return color;};var AddPipline=function AddPipline(){var color=getRandomColor();var pipline={id:piplinesCount+1,name:\"Трубопровод \"+(piplinesCount+1),color:color,points:[]};piplines.push(pipline);piplinesCount+=1;renderPiplineItems();if(piplines.length<=1){activePipline=0;setPipline(0);}};var DeletePipline=function DeletePipline(id){for(var key in piplines){if(Object.hasOwnProperty.call(piplines,key)){var pipline=piplines[key];if(pipline.id===id){if(key==='0'){piplines.shift();piplinesCount=0;activePipline=-1;}else{piplines.splice(key,key);}renderPiplineItems();DrawPipeline();}}}};var deleteSelectedPoint=function deleteSelectedPoint(){if(selectedNumber&&selectedNumber.point===0){piplines[selectedNumber.key].points.shift();selectedNumber=-1;DrawPipeline();}else if(selectedNumber&&selectedNumber.point===piplines[selectedNumber.key].points.length-1){piplines[selectedNumber.key].points.pop();selectedNumber=-1;DrawPipeline();}else{renderAlert();}};var addPointsToPipline=function addPointsToPipline(piplineIndex,x,y){var point={x:x,y:y};piplines[piplineIndex].points.push(point);};var TrySelectPoint=function TrySelectPoint(x,y){piplines.forEach(function(pipline,key){for(var i=0;i<pipline.points.length;i++){var point=pipline.points[i];if(x>=point.x-5&&x<=point.x+5&&y>=point.y-5&&y<=point.y+5){selectedNumber={key:key,point:i};DrawPipeline();downOnSelected=true;break;}}});};function HandleMouseDown(event){mouseDown=true;if(AddPointActive){var x=event.offsetX;var y=event.offsetY;addPointsToPipline(activePipline,x,y);DrawPipeline();AddPointActive=false;}else{x=event.offsetX;y=event.offsetY;TrySelectPoint(x,y);}}function HandleMouseMove(event){if(mouseDown){if(downOnSelected){var point=piplines[selectedNumber.key].points[selectedNumber.point];point.x=event.offsetX;point.y=event.offsetY;DrawPipeline();}}}function HandleMouseUp(){mouseDown=false;downOnSelected=false;deActiveCanvas();}function DrawPipeline(){var canvas=document.getElementById('piplineCanvas');var ctx=canvas.getContext('2d');ctx.clearRect(0,0,canvas.width,canvas.height);if(points.length>0){DrawLines();}piplines.forEach(function(pipline,keys){for(var key in pipline.points){if(Object.hasOwnProperty.call(pipline.points,key)){if(pipline.points.length>0){DrawLines();}var point=pipline.points[key];if(Number(keys)===selectedNumber.key&&Number(key)===selectedNumber.point){DrawPoint(point.x,point.y,\"blue\");}else{DrawPoint(point.x,point.y,pipline.color);}}}});}function DrawPoint(x,y,color){var canvas=document.getElementById('piplineCanvas');var ctx=canvas.getContext('2d');ctx.beginPath();ctx.arc(x,y,5,0,getRadians(360));ctx.fillStyle=color;ctx.moveTo(x,y);ctx.fill();}function DrawLines(){var canvas=document.getElementById('piplineCanvas');var ctx=canvas.getContext('2d');for(var key in piplines){if(Object.hasOwnProperty.call(piplines,key)){var pipline=piplines[key];if(pipline.points.length>0){ctx.moveTo(pipline.points[0].x,pipline.points[0].y);for(var i=0;i<pipline.points.length;i++){ctx.lineTo(pipline.points[i].x,pipline.points[i].y);ctx.strokeStyle=pipline.color;}}}ctx.stroke();ctx.beginPath();}}function getRadians(degrees){return Math.PI/180*degrees;}var intersect=function intersect(x1,y1,x2,y2,x3,y3,x4,y4){// Check if none of the lines are of length 0\nif(x1===x2&&y1===y2||x3===x4&&y3===y4){return false;}var denominator=(y4-y3)*(x2-x1)-(x4-x3)*(y2-y1);// Lines are parallel\nif(denominator===0){return false;}var ua=((x4-x3)*(y1-y3)-(y4-y3)*(x1-x3))/denominator;var ub=((x2-x1)*(y1-y3)-(y2-y1)*(x1-x3))/denominator;// is the intersection along the segments\nif(ua<0||ua>1||ub<0||ub>1){return false;}// Return a object with the x and y coordinates of the intersection\nvar x=x1+ua*(x2-x1);var y=y1+ua*(y2-y1);return{x:x,y:y};};var getCollisium=function getCollisium(){var allLines=getAlllines();for(var i=0;i<allLines.length-1;i++){for(var y=1;y<allLines.length;y++){var line1=allLines[i];var line2=allLines[y];var point=intersect(line1.x1,line1.y1,line1.x2,line1.y2,line2.x1,line2.y1,line2.x2,line2.y2);if(point.x&&point.y){if(point.x<0&&point.y<0||point.x==line1.x2&&point.y==line1.y2||point.x==line2.x1&&point.y==line2.y1||point.x==line1.x1&&point.y==line1.y1||point.x==line2.x2&&point.y==line2.y2){console.log('break');}else{DrawPoint(point.x,point.y,\"red\");}}}}};var getAlllines=function getAlllines(){var allLines=[];for(var i=0;i<piplines.length;i++){//количество иттераций от количества пайплайнов:\nfor(var y=0;y<piplines[i].points.length;y++){//вложенные иттерации от количества поинтов в пайплайне \nvar line1={};if(piplines[i].points[y+1]){line1={x1:piplines[i].points[y].x,y1:piplines[i].points[y].y,x2:piplines[i].points[y+1].x,y2:piplines[i].points[y+1].y};allLines.push(line1);}else{break;}}}return allLines;};","map":{"version":3,"sources":["C:/Users/drack90/source/repos/appTestRosneft/ClientApp/src/components/Pipline.js"],"names":["React","Component","render","Pipline","state","piplinesSegmentCount","closeAlert","e","newEvent","nativeEvent","HandleMouseDown","HandleMouseUp","HandleMouseMove","AddPipline","SetAddPointActive","deleteSelectedPoint","getCollisium","dislpayName","name","piplines","mouseDown","piplinesCount","defaultId","defaultPoint","AddPointActive","downOnSelected","points","selectedNumber","activePipline","linesArr","pipline","point","activeCanvas","color","canvas","document","getElementById","style","borderColor","deActiveCanvas","defaultColor","renderAlert","classList","add","autoCloseAlert","time","setTimeout","remove","renderPiplineItems","map","item","key","setPipline","DeletePipline","id","getRandomColor","letters","i","Math","floor","random","push","length","Object","hasOwnProperty","call","shift","splice","DrawPipeline","pop","addPointsToPipline","piplineIndex","x","y","TrySelectPoint","forEach","event","offsetX","offsetY","ctx","getContext","clearRect","width","height","DrawLines","keys","Number","DrawPoint","beginPath","arc","getRadians","fillStyle","moveTo","fill","lineTo","strokeStyle","stroke","degrees","PI","intersect","x1","y1","x2","y2","x3","y3","x4","y4","denominator","ua","ub","allLines","getAlllines","line1","line2","console","log"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { render } from 'react-dom'\r\nimport './css/Pipline.css'\r\n\r\n\r\nexport class Pipline extends Component {\r\n    static dislpayName = Pipline.name;\r\n\r\n    state = {\r\n        piplinesSegmentCount: 0\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <section className=\"piplineSections\">\r\n                <div className=\"alert alert-danger alert-dismissible fade\" id=\"alert-message\" role=\"alert\">\r\n                    Удалить можно только первую и последнюю точку трубопровода.\r\n                        <button type=\"button\" className=\"close\" data-dismiss=\"alert\" aria-label=\"Close\" onClick={closeAlert}>\r\n                            <span aria-hidden=\"true\">&times;</span>\r\n                        </button>\r\n                    </div>\r\n                <div className=\"container\">\r\n                    <div className=\"pipline-title mx-auto\">\r\n                        <h1>Тестовое задание</h1>\r\n                        <h6>Задача: реализовать построение и обработку трубопроводов с проверкой коллизий</h6>\r\n                    </div>\r\n                   <div className=\"row\">\r\n                        <div className=\"col-xxl-8 col-xl-8 col-lg-8\">\r\n                            <div className=\"canvasContainer\">\r\n                                <canvas id=\"piplineCanvas\" width=\"700\" height=\"350\"\r\n                                    onMouseDown={(e) => {\r\n                                        let newEvent = e.nativeEvent;\r\n                                        HandleMouseDown(newEvent)\r\n                                    }}\r\n                                    onMouseUp={e => {\r\n                                        let newEvent = e.nativeEvent;\r\n                                        HandleMouseUp(newEvent);\r\n                                    }}\r\n                                    onMouseMove={e => {\r\n                                        let newEvent = e.nativeEvent;\r\n                                        HandleMouseMove(newEvent);\r\n                                    }}                                >\r\n                                </canvas>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col-xxl-4 col-xl-4 col-lg-4\">\r\n                            <div className=\"boardContainer\">\r\n                                <div className=\"canvasBoard_componen\">\r\n                                    <button className=\"btn btn-primary\" onClick={AddPipline}> Добавить новый трубопровод </button>\r\n                                    <button className=\"btn btn-success\" onClick={SetAddPointActive}> Добавить узел </button>\r\n                                    <button className=\"btn btn-danger\" onClick={deleteSelectedPoint}> Удалить узел </button>\r\n                                    <button className=\"btn btn-warning\" onClick={getCollisium}> Рассчитать пересечения</button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"piplineElements\" id=\"piplineItems\">\r\n                                <ul className=\"piplineList\" id=\"piplineList\">\r\n                                    \r\n                                </ul>\r\n                            </div>\r\n                        </div>\r\n                   </div>\r\n                </div>    \r\n            </section>\r\n           \r\n        );\r\n    }\r\n\r\n\r\n    \r\n}\r\n\r\n\r\n\r\nlet piplines = []\r\nlet mouseDown = false\r\nlet piplinesCount = 0;\r\nlet defaultId = 0;\r\nlet defaultPoint = [0, 0]\r\nlet AddPointActive = false\r\nlet downOnSelected = false;\r\nlet points = []\r\nlet selectedNumber = -1;\r\nlet activePipline = -1;\r\nlet linesArr = []\r\n\r\n \r\n\r\nfunction SetAddPointActive(pipline, point) {\r\n    activeCanvas()\r\n    AddPointActive = true;\r\n}\r\n\r\nlet activeCanvas = () => {\r\n    let color = piplines[activePipline].color\r\n    let canvas = document.getElementById('piplineCanvas')\r\n    canvas.style.borderColor = color\r\n}\r\n\r\nlet deActiveCanvas =() =>{\r\n    let defaultColor = '#1b6ec2'\r\n    let canvas = document.getElementById('piplineCanvas')\r\n    canvas.style.borderColor = defaultColor\r\n}\r\n\r\n\r\nlet renderAlert = () => {\r\n    document.getElementById('alert-message').classList.add('show')\r\n    autoCloseAlert(2000)\r\n}\r\nlet autoCloseAlert = (time) => {\r\n    setTimeout(() => {\r\n        closeAlert()\r\n    }, time);\r\n}\r\n\r\nlet closeAlert= () => {\r\n    document.getElementById('alert-message').classList.remove('show')\r\n}\r\n\r\nlet renderPiplineItems = () => {\r\n    return render(\r\n        piplines.map((item, key) => (\r\n            <li key={item.id} id={key + \"pipline\"}>\r\n                <button className=\"pipline-btn\" type=\"button\" onClick={() =>setPipline(key)}>{item.name}</button> \r\n                    <button type=\"button\" className=\"close red\" aria-label=\"Close\" onClick={()=>DeletePipline(item.id)}>\r\n                            <span aria-hidden=\"true\">&times;</span>\r\n                    </button>\r\n            </li>\r\n        )),\r\n        document.getElementById('piplineList')\r\n    );\r\n}\r\n\r\n\r\nlet setPipline = (key) => {\r\n    if (activePipline !== key && activePipline !== -1 && document.getElementById(activePipline + \"pipline\")) {\r\n        document.getElementById(activePipline + \"pipline\").classList.remove('pipline-btn__active')\r\n    }\r\n    let pipline = document.getElementById(key + \"pipline\")\r\n\r\n    if(pipline){\r\n        pipline.classList.add('pipline-btn__active')\r\n        activePipline = key;\r\n\r\n    }\r\n    \r\n}\r\n\r\nlet getRandomColor = () => {\r\n    var letters = '0123456789ABCDEF';\r\n    var color = '#';\r\n    for (var i = 0; i < 6; i++) {\r\n        color += letters[Math.floor(Math.random() * 16)];\r\n    }\r\n    return color;\r\n}\r\n\r\nlet AddPipline = () => {\r\n    let color = getRandomColor()\r\n    let pipline = {\r\n        id: piplinesCount + 1,\r\n        name: \"Трубопровод \" + (piplinesCount + 1),\r\n        color: color,\r\n        points: []\r\n    }\r\n    piplines.push(pipline)\r\n    piplinesCount += 1\r\n    renderPiplineItems()\r\n    if (piplines.length <= 1) {\r\n        activePipline = 0\r\n        setPipline(0)\r\n    }\r\n}\r\n\r\n\r\nlet DeletePipline = (id) => {\r\n\r\n    for (const key in piplines) {\r\n        if (Object.hasOwnProperty.call(piplines, key)) {\r\n            const pipline = piplines[key];\r\n            if(pipline.id === id){\r\n                if(key === '0'){\r\n                    piplines.shift()\r\n                    piplinesCount = 0\r\n                    activePipline = -1\r\n                }else{\r\n                    piplines.splice(key, key)\r\n                }\r\n                renderPiplineItems();\r\n                DrawPipeline();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nlet deleteSelectedPoint = () =>{\r\n        if(selectedNumber && selectedNumber.point === 0){\r\n            piplines[selectedNumber.key].points.shift()\r\n            selectedNumber = -1;\r\n            DrawPipeline()\r\n        }else if(selectedNumber && selectedNumber.point === piplines[selectedNumber.key].points.length -1){\r\n            piplines[selectedNumber.key].points.pop()\r\n            selectedNumber = -1;\r\n            DrawPipeline()\r\n        }else{\r\n            renderAlert()\r\n        }\r\n       \r\n    \r\n}\r\n\r\n\r\nlet addPointsToPipline = (piplineIndex, x, y) =>{\r\n    let point = {x, y};\r\n    piplines[piplineIndex].points.push(point);\r\n}\r\n\r\nlet TrySelectPoint = (x, y) => {\r\n    piplines.forEach((pipline, key) =>{\r\n        for (var i = 0; i < pipline.points.length; i++) {\r\n            var point = pipline.points[i];\r\n            if (x >= point.x - 5 && x <= point.x + 5 && y >= point.y - 5 && y <= point.y + 5) {\r\n                selectedNumber = {key: key, point: i};\r\n                DrawPipeline();\r\n                downOnSelected = true;\r\n                break\r\n            }\r\n        }\r\n    })    \r\n}\r\nfunction HandleMouseDown(event) {\r\n    mouseDown = true;\r\n    if (AddPointActive) {\r\n        var x = event.offsetX;\r\n        var y = event.offsetY;\r\n        addPointsToPipline(activePipline, x, y)\r\n        DrawPipeline();\r\n        AddPointActive = false;\r\n    }\r\n    else {\r\n        x = event.offsetX;\r\n        y = event.offsetY;\r\n        TrySelectPoint(x, y);\r\n    }\r\n\r\n}\r\nfunction HandleMouseMove(event) {\r\n    if (mouseDown) {\r\n        if (downOnSelected) {\r\n            let point = piplines[selectedNumber.key].points[selectedNumber.point];\r\n            point.x = event.offsetX;\r\n            point.y = event.offsetY;\r\n            DrawPipeline();\r\n        }\r\n    }\r\n}\r\n\r\nfunction HandleMouseUp() {\r\n    mouseDown = false;\r\n    downOnSelected = false;\r\n    deActiveCanvas()\r\n}\r\n\r\nfunction DrawPipeline() {\r\n    var canvas = document.getElementById('piplineCanvas');\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    if (points.length > 0) {\r\n        DrawLines();\r\n    }\r\n    piplines.forEach((pipline, keys) => {\r\n        for (const key in pipline.points) {\r\n            if (Object.hasOwnProperty.call(pipline.points, key)) {\r\n                if(pipline.points.length > 0){\r\n                    DrawLines();\r\n                }\r\n                const point = pipline.points[key];\r\n                if(Number(keys) === selectedNumber.key && Number(key) === selectedNumber.point){\r\n                    DrawPoint(point.x, point.y, \"blue\")\r\n                }else{\r\n                    DrawPoint(point.x, point.y, pipline.color)\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n}\r\n\r\nfunction DrawPoint(x, y, color) {\r\n    var canvas = document.getElementById('piplineCanvas');\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, 5, 0, getRadians(360));\r\n    ctx.fillStyle = color;\r\n    ctx.moveTo(x, y);\r\n    ctx.fill();\r\n}\r\n\r\nfunction DrawLines() {\r\n    var canvas = document.getElementById('piplineCanvas');\r\n    var ctx = canvas.getContext('2d');\r\n    for (const key in piplines) {\r\n        if (Object.hasOwnProperty.call(piplines, key) ) {\r\n            const pipline = piplines[key];\r\n            if(pipline.points.length > 0 ){\r\n                ctx.moveTo(pipline.points[0].x, pipline.points[0].y);\r\n                for (var i = 0; i < pipline.points.length; i++) {\r\n                    ctx.lineTo(pipline.points[i].x, pipline.points[i].y);                \r\n                    ctx.strokeStyle = pipline.color;\r\n                }\r\n            }\r\n        }\r\n        ctx.stroke()\r\n        ctx.beginPath();\r\n    }\r\n\r\n}\r\n\r\nfunction getRadians(degrees) {\r\n    return (Math.PI / 180) * degrees;\r\n}\r\n\r\nlet intersect = (x1, y1, x2, y2, x3, y3, x4, y4) => {\r\n        // Check if none of the lines are of length 0\r\n          if ((x1 === x2 && y1 === y2) || (x3 === x4 && y3 === y4)) {\r\n              return false\r\n          }\r\n      \r\n          let denominator = ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1))\r\n      \r\n        // Lines are parallel\r\n          if (denominator === 0) {\r\n              return false\r\n          }\r\n      \r\n          let ua = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denominator\r\n          let ub = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denominator\r\n      \r\n        // is the intersection along the segments\r\n          if (ua < 0 || ua > 1 || ub < 0 || ub > 1) {\r\n              return false\r\n          }\r\n      \r\n        // Return a object with the x and y coordinates of the intersection\r\n          let x = x1 + ua * (x2 - x1)\r\n          let y = y1 + ua * (y2 - y1)\r\n      \r\n          return {x, y}\r\n}\r\n\r\n\r\nlet getCollisium = () =>{\r\n        let allLines = getAlllines()\r\n    for (let i = 0; i < allLines.length -1; i++) {\r\n        for (let y = 1; y < allLines.length; y++) {\r\n            const line1 = allLines[i];\r\n\r\n            const line2 = allLines[y]\r\n            let point = intersect(line1.x1, line1.y1, line1.x2, line1.y2, line2.x1, line2.y1,line2.x2, line2.y2)\r\n            if(point.x && point.y){\r\n                if(point.x < 0 && point.y < 0 || \r\n                point.x == line1.x2 && point.y == line1.y2 || \r\n                point.x == line2.x1 && point.y == line2.y1 || \r\n                point.x == line1.x1 && point.y == line1.y1 || \r\n                point.x == line2.x2 && point.y == line2.y2){\r\n                    console.log('break');\r\n                }else{\r\n                    DrawPoint(point.x, point.y, \"red\")\r\n                }\r\n            }\r\n        }\r\n        \r\n        \r\n    }\r\n}\r\n\r\nlet getAlllines = () => { \r\n    let allLines = []\r\n    for (let i = 0; i < piplines.length; i++) { //количество иттераций от количества пайплайнов:\r\n        for (let y = 0; y < piplines[i].points.length; y++) { //вложенные иттерации от количества поинтов в пайплайне \r\n            let line1 = {}\r\n            if(piplines[i].points[y+1]){\r\n                line1 = {x1:piplines[i].points[y].x, \r\n                         y1:piplines[i].points[y].y,\r\n                         x2:piplines[i].points[y+1].x, \r\n                         y2:piplines[i].points[y+1].y}\r\n                         allLines.push(line1)\r\n            }else{\r\n                break;\r\n            }\r\n        \r\n\r\n            \r\n        }\r\n    }\r\n    return allLines;\r\n}"]},"metadata":{},"sourceType":"module"}